{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 8.264211654663086,
      "cost_test": 12.922880172729492,
      "alpha": [
        1.9400055787201653,
        0.059992734327189476
      ],
      "mu": [
        0.0,
        5.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.46045191688303605,
        "worst_group_error": 0.5288491056136034,
        "coverage": 0.999000072479248,
        "rejection_rate": 0.0009999275207519531,
        "group_errors": [
          0.39205472815246867,
          0.5288491056136034
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4759432346549891,
        "worst_group_error": 0.5468185467523903,
        "coverage": 0.9998750686645508,
        "rejection_rate": 0.00012493133544921875,
        "group_errors": [
          0.4050679225575879,
          0.5468185467523903
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 1.1628985404968262,
      "cost_test": 1.186678171157837,
      "alpha": [
        1.8033763738119175,
        0.05122071322827662
      ],
      "mu": [
        0.0,
        20.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4226416394026781,
        "worst_group_error": 0.48309002938443524,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.362193249420921,
          0.48309002938443524
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4369513999253612,
        "worst_group_error": 0.4990874916175656,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.3748153082331568,
          0.4990874916175656
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 1.5243487358093262,
      "cost_test": 1.5373806953430176,
      "alpha": [
        1.6822426513263788,
        0.04168541418778971
      ],
      "mu": [
        0.0,
        15.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3782651863207058,
        "worst_group_error": 0.425687263043963,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.3308431095974487,
          0.425687263043963
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4007617973560822,
        "worst_group_error": 0.45552211505145,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.34600147966071443,
          0.45552211505145
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 1.2717187404632568,
      "cost_test": 1.2333829402923584,
      "alpha": [
        1.4781594786895158,
        0.03734597894157267
      ],
      "mu": [
        0.0,
        18.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.33519499239725403,
        "worst_group_error": 0.38313980945641274,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.2872501753380953,
          0.38313980945641274
        ]
      },
      "test_metrics": {
        "balanced_error": 0.352757034406331,
        "worst_group_error": 0.4074594690214618,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.29805459979120014,
          0.4074594690214618
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 1.260513186454773,
      "cost_test": 1.1700003147125244,
      "alpha": [
        1.3363460377077354,
        0.03153197081634006
      ],
      "mu": [
        0.0,
        19.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2801106943917917,
        "worst_group_error": 0.29709229816264715,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.26312909062093626,
          0.29709229816264715
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3129818088436054,
        "worst_group_error": 0.3589276813332218,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.26703593635398903,
          0.3589276813332218
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 1.108354091644287,
      "cost_test": 1.0366530418395996,
      "alpha": [
        1.1641022197599598,
        0.0260739954074138
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.21876207245438858,
        "worst_group_error": 0.22420077822757709,
        "coverage": 0.5010000467300415,
        "rejection_rate": 0.4989999532699585,
        "group_errors": [
          0.22420077822757709,
          0.21332336668120008
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2622799144925308,
        "worst_group_error": 0.29564403550976426,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.22891579347529736,
          0.29564403550976426
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 1.6242990493774414,
      "cost_test": 1.5900925397872925,
      "alpha": [
        1.0190380265176318,
        0.01854897219996271
      ],
      "mu": [
        0.0,
        11.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.1893128882000389,
        "worst_group_error": 0.2081448152434955,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.1704809611565823,
          0.2081448152434955
        ]
      },
      "test_metrics": {
        "balanced_error": 0.22005742481888133,
        "worst_group_error": 0.2553332523354156,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.18478159730234706,
          0.2553332523354156
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 1.4528741836547852,
      "cost_test": 1.440251350402832,
      "alpha": [
        0.8044176950512023,
        0.012779875266485061
      ],
      "mu": [
        0.0,
        17.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.15160173639791605,
        "worst_group_error": 0.15759907055513833,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.15759907055513833,
          0.14560440224069376
        ]
      },
      "test_metrics": {
        "balanced_error": 0.15910988535933063,
        "worst_group_error": 0.16805645114307785,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.1501633195755834,
          0.16805645114307785
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 1.3731868267059326,
      "cost_test": 1.239579200744629,
      "alpha": [
        0.549015864703845,
        0.0088027948797424
      ],
      "mu": [
        0.0,
        15.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.09770381713963916,
        "worst_group_error": 0.10319452126270093,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.10319452126270093,
          0.09221311301657739
        ]
      },
      "test_metrics": {
        "balanced_error": 0.10267797100613767,
        "worst_group_error": 0.10284007476284633,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.10284007476284633,
          0.102515867249429
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0009999275207519531,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.4989999532699585,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.46045191688303605,
        0.4226416394026781,
        0.3782651863207058,
        0.33519499239725403,
        0.2801106943917917,
        0.21876207245438858,
        0.1893128882000389,
        0.15160173639791605,
        0.09770381713963916
      ],
      "worst_group_errors": [
        0.5288491056136034,
        0.48309002938443524,
        0.425687263043963,
        0.38313980945641274,
        0.29709229816264715,
        0.22420077822757709,
        0.2081448152434955,
        0.15759907055513833,
        0.10319452126270093
      ],
      "tail_minus_head": [
        0.13679437746113476,
        0.12089677996351422,
        0.09484415344651426,
        0.09588963411831741,
        0.033963207541710894,
        -0.010877411546377003,
        0.03766385408691322,
        -0.011994668314444568,
        -0.010981408246123536
      ],
      "aurc_balanced": 0.2248057459444228,
      "aurc_worst_group": 0.24873099590954847,
      "aurc_balanced_coverage_ge_0_2": 0.2248057459444228,
      "aurc_worst_group_coverage_ge_0_2": 0.24873099590954847
    },
    "test": {
      "rejection_rates": [
        0.00012493133544921875,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.4759432346549891,
        0.4369513999253612,
        0.4007617973560822,
        0.352757034406331,
        0.3129818088436054,
        0.2622799144925308,
        0.22005742481888133,
        0.15910988535933063,
        0.10267797100613767
      ],
      "worst_group_errors": [
        0.5468185467523903,
        0.4990874916175656,
        0.45552211505145,
        0.4074594690214618,
        0.3589276813332218,
        0.29564403550976426,
        0.2553332523354156,
        0.16805645114307785,
        0.10284007476284633
      ],
      "tail_minus_head": [
        0.1417506241948024,
        0.12427218338440882,
        0.10952063539073559,
        0.10940486923026166,
        0.09189174497923275,
        0.0667282420344669,
        0.07055165503306854,
        0.017893131567494447,
        -0.00032420751341732945
      ],
      "aurc_balanced": 0.24332799830657342,
      "aurc_worst_group": 0.27637972517645015,
      "aurc_balanced_coverage_ge_0_2": 0.24332799830657342,
      "aurc_worst_group_coverage_ge_0_2": 0.27637972517645015
    }
  }
}