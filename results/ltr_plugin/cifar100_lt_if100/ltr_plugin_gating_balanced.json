{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 18.426355361938477,
      "cost_test": 21.85616683959961,
      "alpha": [
        1.9400231509356174,
        0.059958588288599665
      ],
      "mu": [
        0.0,
        -5.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4917324158267806,
        "worst_group_error": 0.5456186647035506,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.5456186647035506,
          0.43784616695001066
        ]
      },
      "test_metrics": {
        "balanced_error": 0.5132841338255121,
        "worst_group_error": 0.5673374609107097,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.5673374609107097,
          0.45923080674031447
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 3.9569363594055176,
      "cost_test": 4.209934234619141,
      "alpha": [
        1.8123053969029899,
        0.05092724476878526
      ],
      "mu": [
        0.0,
        11.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4592190088335021,
        "worst_group_error": 0.5399385709184609,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5399385709184609,
          0.37849944674854336
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4796475814542255,
        "worst_group_error": 0.5500763237489619,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5500763237489619,
          0.4092188391594891
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 1.9347360134124756,
      "cost_test": 1.9382007122039795,
      "alpha": [
        1.616127072407438,
        0.04482185318144909
      ],
      "mu": [
        0.0,
        21.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.42124109712894864,
        "worst_group_error": 0.5008121663573611,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5008121663573611,
          0.3416700279005362
        ]
      },
      "test_metrics": {
        "balanced_error": 0.43218747500479837,
        "worst_group_error": 0.5026881039498536,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5026881039498536,
          0.36168684605974316
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 2.262876033782959,
      "cost_test": 2.2580442428588867,
      "alpha": [
        1.44739024760407,
        0.038906103225993055
      ],
      "mu": [
        0.0,
        19.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3780607255365655,
        "worst_group_error": 0.45894461464932335,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.45894461464932335,
          0.29717683642380766
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3921242336137194,
        "worst_group_error": 0.46123072016582634,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.46123072016582634,
          0.32301774706161246
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 3.0232419967651367,
      "cost_test": 2.826653242111206,
      "alpha": [
        1.29446413177209,
        0.029824077311266836
      ],
      "mu": [
        0.0,
        18.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.31953044864141916,
        "worst_group_error": 0.4352665214774832,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.4352665214774832,
          0.20379437580535517
        ]
      },
      "test_metrics": {
        "balanced_error": 0.35173273830935015,
        "worst_group_error": 0.41645756579886356,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.41645756579886356,
          0.28700791081983673
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 2.7057385444641113,
      "cost_test": 2.528258800506592,
      "alpha": [
        1.1348920006425547,
        0.025645192962027146
      ],
      "mu": [
        0.0,
        18.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2579531174379643,
        "worst_group_error": 0.36263240656824974,
        "coverage": 0.5,
        "rejection_rate": 0.5,
        "group_errors": [
          0.36263240656824974,
          0.15327382830767886
        ]
      },
      "test_metrics": {
        "balanced_error": 0.293813222429967,
        "worst_group_error": 0.3501732644010842,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.3501732644010842,
          0.23745318045884972
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 2.3520469665527344,
      "cost_test": 2.18569278717041,
      "alpha": [
        0.9647880524520422,
        0.019508900780467672
      ],
      "mu": [
        0.0,
        21.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.22984661942159676,
        "worst_group_error": 0.32629681739645805,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.32629681739645805,
          0.13339642144673547
        ]
      },
      "test_metrics": {
        "balanced_error": 0.22704744571450933,
        "worst_group_error": 0.28042673974366794,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.28042673974366794,
          0.1736681516853507
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 2.0666701793670654,
      "cost_test": 1.890289545059204,
      "alpha": [
        0.7574131484010356,
        0.016121623314400625
      ],
      "mu": [
        0.0,
        21.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.15386679640878942,
        "worst_group_error": 0.20904938497768236,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.20904938497768236,
          0.09868420783989645
        ]
      },
      "test_metrics": {
        "balanced_error": 0.16083392981608474,
        "worst_group_error": 0.18559809595348614,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.18559809595348614,
          0.13606976367868334
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 2.849736213684082,
      "cost_test": 2.5283806324005127,
      "alpha": [
        0.5689372617978997,
        0.008477848629571882
      ],
      "mu": [
        0.0,
        14.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.08265147616671287,
        "worst_group_error": 0.10053610954887246,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.10053610954887246,
          0.06476684278455329
        ]
      },
      "test_metrics": {
        "balanced_error": 0.0800781211430447,
        "worst_group_error": 0.10202028477881038,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.10202028477881038,
          0.05813595750727902
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.5,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.4917324158267806,
        0.4592190088335021,
        0.42124109712894864,
        0.3780607255365655,
        0.31953044864141916,
        0.2579531174379643,
        0.22984661942159676,
        0.15386679640878942,
        0.08265147616671287
      ],
      "worst_group_errors": [
        0.5456186647035506,
        0.5399385709184609,
        0.5008121663573611,
        0.45894461464932335,
        0.4352665214774832,
        0.36263240656824974,
        0.32629681739645805,
        0.20904938497768236,
        0.10053610954887246
      ],
      "tail_minus_head": [
        -0.10777249775353992,
        -0.16143912416991751,
        -0.15914213845682496,
        -0.1617677782255157,
        -0.231472145672128,
        -0.2093585782605709,
        -0.19290039594972258,
        -0.1103651771377859,
        -0.03576926676431917
      ],
      "aurc_balanced": 0.25052971845465705,
      "aurc_worst_group": 0.315357849164149,
      "aurc_balanced_coverage_ge_0_2": 0.25052971845465705,
      "aurc_worst_group_coverage_ge_0_2": 0.315357849164149
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.5132841338255121,
        0.4796475814542255,
        0.43218747500479837,
        0.3921242336137194,
        0.35173273830935015,
        0.293813222429967,
        0.22704744571450933,
        0.16083392981608474,
        0.0800781211430447
      ],
      "worst_group_errors": [
        0.5673374609107097,
        0.5500763237489619,
        0.5026881039498536,
        0.46123072016582634,
        0.41645756579886356,
        0.3501732644010842,
        0.28042673974366794,
        0.18559809595348614,
        0.10202028477881038
      ],
      "tail_minus_head": [
        -0.10810665417039522,
        -0.14085748458947278,
        -0.14100125789011048,
        -0.13821297310421388,
        -0.12944965497902683,
        -0.11272008394223448,
        -0.10675858805831723,
        -0.0495283322748028,
        -0.04388432727153136
      ],
      "aurc_balanced": 0.26337642797034755,
      "aurc_worst_group": 0.30809779544498467,
      "aurc_balanced_coverage_ge_0_2": 0.26337642797034755,
      "aurc_worst_group_coverage_ge_0_2": 0.30809779544498467
    }
  }
}