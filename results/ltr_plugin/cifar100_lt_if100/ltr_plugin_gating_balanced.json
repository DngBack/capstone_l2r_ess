{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 20.505083084106445,
      "cost_test": 24.981555938720703,
      "alpha": [
        1.9400005173318404,
        0.0599927095693743
      ],
      "mu": [
        0.0,
        -5.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.5209735359510128,
        "worst_group_error": 0.6077931932725522,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.6077931932725522,
          0.4341538786294733
        ]
      },
      "test_metrics": {
        "balanced_error": 0.5163318501808065,
        "worst_group_error": 0.6064329174295764,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.6064329174295764,
          0.42623078293203653
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 2.2921931743621826,
      "cost_test": 2.1593708992004395,
      "alpha": [
        1.7823759919148383,
        0.0533218747191747
      ],
      "mu": [
        0.0,
        22.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4878248830373716,
        "worst_group_error": 0.5869957568352553,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5869957568352553,
          0.38865400923948784
        ]
      },
      "test_metrics": {
        "balanced_error": 0.47924568439468684,
        "worst_group_error": 0.5805461701513075,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5805461701513075,
          0.37794519863806614
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 1.9631131887435913,
      "cost_test": 1.9745607376098633,
      "alpha": [
        1.5841559372040104,
        0.04638616951581231
      ],
      "mu": [
        0.0,
        23.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.44379484508786043,
        "worst_group_error": 0.5421569028056069,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5421569028056069,
          0.34543278737011396
        ]
      },
      "test_metrics": {
        "balanced_error": 0.44389029795434354,
        "worst_group_error": 0.5452730527895593,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5452730527895593,
          0.34250754311912773
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 2.616787910461426,
      "cost_test": 2.742249011993408,
      "alpha": [
        1.4276528453676223,
        0.03711670458076714
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.41543581656690776,
        "worst_group_error": 0.5020125873752013,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.5020125873752013,
          0.3288590457586142
        ]
      },
      "test_metrics": {
        "balanced_error": 0.41005853781237844,
        "worst_group_error": 0.5180108919831101,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.5180108919831101,
          0.30210618364164676
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 4.103981018066406,
      "cost_test": 4.498000621795654,
      "alpha": [
        1.3269414631252054,
        0.028315699805519005
      ],
      "mu": [
        0.0,
        18.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3785863588132342,
        "worst_group_error": 0.4908027184024708,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.4908027184024708,
          0.2663699992239977
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3780410656135184,
        "worst_group_error": 0.5066040411785739,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.5066040411785739,
          0.24947809004846286
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 2.919769287109375,
      "cost_test": 3.0309367179870605,
      "alpha": [
        1.1507666754483326,
        0.024605735990829374
      ],
      "mu": [
        0.0,
        23.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.31673887062114714,
        "worst_group_error": 0.42435226655533953,
        "coverage": 0.5010000467300415,
        "rejection_rate": 0.4989999532699585,
        "group_errors": [
          0.42435226655533953,
          0.2091254746869548
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3176375798034321,
        "worst_group_error": 0.4281502674316751,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.4281502674316751,
          0.20712489217518906
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 4.362514019012451,
      "cost_test": 4.446136474609375,
      "alpha": [
        1.0010586271360324,
        0.015071364755508045
      ],
      "mu": [
        0.0,
        21.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2625832282621118,
        "worst_group_error": 0.38096950878392494,
        "coverage": 0.4000000059604645,
        "rejection_rate": 0.5999999940395355,
        "group_errors": [
          0.38096950878392494,
          0.1441969477402986
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2893843039353575,
        "worst_group_error": 0.41362337044099184,
        "coverage": 0.4000000059604645,
        "rejection_rate": 0.5999999940395355,
        "group_errors": [
          0.41362337044099184,
          0.16514523742972317
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 4.1895246505737305,
      "cost_test": 4.535135269165039,
      "alpha": [
        0.7965610207073976,
        0.011397821229396029
      ],
      "mu": [
        0.0,
        15.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.17296520046200797,
        "worst_group_error": 0.2958340652306805,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.2958340652306805,
          0.05009633569333546
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2178527529255911,
        "worst_group_error": 0.3136969686286923,
        "coverage": 0.30000001192092896,
        "rejection_rate": 0.699999988079071,
        "group_errors": [
          0.3136969686286923,
          0.12200853722248987
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 2.6855294704437256,
      "cost_test": 3.083648920059204,
      "alpha": [
        0.5439518503604908,
        0.009281549252059037
      ],
      "mu": [
        0.0,
        22.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.08264882544204791,
        "worst_group_error": 0.16529765088409581,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.16529765088409581,
          0.0
        ]
      },
      "test_metrics": {
        "balanced_error": 0.10665881612966732,
        "worst_group_error": 0.14223265406130423,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.14223265406130423,
          0.07108497819803042
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.4989999532699585,
        0.5999999940395355,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.5209735359510128,
        0.4878248830373716,
        0.44379484508786043,
        0.41543581656690776,
        0.3785863588132342,
        0.31673887062114714,
        0.2625832282621118,
        0.17296520046200797,
        0.08264882544204791
      ],
      "worst_group_errors": [
        0.6077931932725522,
        0.5869957568352553,
        0.5421569028056069,
        0.5020125873752013,
        0.4908027184024708,
        0.42435226655533953,
        0.38096950878392494,
        0.2958340652306805,
        0.16529765088409581
      ],
      "tail_minus_head": [
        -0.1736393146430789,
        -0.19834174759576745,
        -0.19672411543549295,
        -0.17315354161658708,
        -0.22443271917847313,
        -0.21522679186838473,
        -0.23677256104362635,
        -0.24573772953734505,
        -0.16529765088409581
      ],
      "aurc_balanced": 0.2776982516580643,
      "aurc_worst_group": 0.36057359336990896,
      "aurc_balanced_coverage_ge_0_2": 0.2776982516580643,
      "aurc_worst_group_coverage_ge_0_2": 0.36057359336990896
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5999999940395355,
        0.699999988079071,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.5163318501808065,
        0.47924568439468684,
        0.44389029795434354,
        0.41005853781237844,
        0.3780410656135184,
        0.3176375798034321,
        0.2893843039353575,
        0.2178527529255911,
        0.10665881612966732
      ],
      "worst_group_errors": [
        0.6064329174295764,
        0.5805461701513075,
        0.5452730527895593,
        0.5180108919831101,
        0.5066040411785739,
        0.4281502674316751,
        0.41362337044099184,
        0.3136969686286923,
        0.14223265406130423
      ],
      "tail_minus_head": [
        -0.18020213449753986,
        -0.20260097151324136,
        -0.20276550967043155,
        -0.21590470834146336,
        -0.25712595113011105,
        -0.22102537525648605,
        -0.24847813301126867,
        -0.1916884314062024,
        -0.07114767586327381
      ],
      "aurc_balanced": 0.28473472310091397,
      "aurc_worst_group": 0.367989438162527,
      "aurc_balanced_coverage_ge_0_2": 0.28473472310091397,
      "aurc_worst_group_coverage_ge_0_2": 0.367989438162527
    }
  }
}