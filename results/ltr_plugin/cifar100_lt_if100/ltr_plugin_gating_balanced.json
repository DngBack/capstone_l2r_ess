{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 19.221874237060547,
      "cost_test": 19.151409149169922,
      "alpha": [
        1.9400074333784052,
        0.05998109799806144
      ],
      "mu": [
        0.0,
        -5.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4627977928783108,
        "worst_group_error": 0.4926724805104102,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.4926724805104102,
          0.43292310524621136
        ]
      },
      "test_metrics": {
        "balanced_error": 0.469235694603072,
        "worst_group_error": 0.48297135234787425,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.48297135234787425,
          0.45550003685826984
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 2.4698688983917236,
      "cost_test": 2.378451347351074,
      "alpha": [
        1.8059722328859857,
        0.050931596293604206
      ],
      "mu": [
        0.0,
        13.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4271198711184234,
        "worst_group_error": 0.481180840791261,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.481180840791261,
          0.3730589014455859
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4359604463597616,
        "worst_group_error": 0.47267347862273346,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.47267347862273346,
          0.3992474140967898
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 1.4117763042449951,
      "cost_test": 1.4496257305145264,
      "alpha": [
        1.5727861094823297,
        0.045460311624782146
      ],
      "mu": [
        0.0,
        22.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3925547706925654,
        "worst_group_error": 0.441096760101186,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.441096760101186,
          0.34401278128394486
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3947824411993627,
        "worst_group_error": 0.43275259010955397,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.43275259010955397,
          0.35681229228917133
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 1.9666974544525146,
      "cost_test": 2.0022430419921875,
      "alpha": [
        1.4866016092535417,
        0.034287690519866854
      ],
      "mu": [
        0.0,
        19.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.37614272413152045,
        "worst_group_error": 0.4613670376971025,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.4613670376971025,
          0.29091841056593837
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3689486985841257,
        "worst_group_error": 0.42776102966094387,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.42776102966094387,
          0.3101363675073076
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 1.7364704608917236,
      "cost_test": 1.7714345455169678,
      "alpha": [
        1.3076462694532478,
        0.02955224316874827
      ],
      "mu": [
        0.0,
        22.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3338784873034014,
        "worst_group_error": 0.43478859865324737,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.43478859865324737,
          0.23296837595355543
        ]
      },
      "test_metrics": {
        "balanced_error": 0.32452622701975126,
        "worst_group_error": 0.38764526737516414,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.38764526737516414,
          0.2614071866643384
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 2.6769981384277344,
      "cost_test": 2.6687211990356445,
      "alpha": [
        1.2118945686193647,
        0.019392893526189885
      ],
      "mu": [
        0.0,
        15.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3114205873264949,
        "worst_group_error": 0.4469790893896481,
        "coverage": 0.5010000467300415,
        "rejection_rate": 0.4989999532699585,
        "group_errors": [
          0.4469790893896481,
          0.17586208526334168
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2900257452731081,
        "worst_group_error": 0.37983102476711267,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.37983102476711267,
          0.2002204657791035
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 2.2368874549865723,
      "cost_test": 2.2622268199920654,
      "alpha": [
        1.04070970796971,
        0.016413461825818938
      ],
      "mu": [
        0.0,
        17.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2541429571270124,
        "worst_group_error": 0.40691917598484667,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.40691917598484667,
          0.10136673826917816
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2361513072374946,
        "worst_group_error": 0.31845646062883537,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.31845646062883537,
          0.15384615384615385
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 1.8358781337738037,
      "cost_test": 1.8806287050247192,
      "alpha": [
        0.7896509938017722,
        0.013662913665562132
      ],
      "mu": [
        0.0,
        21.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.19103887697318642,
        "worst_group_error": 0.3108448791509514,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.3108448791509514,
          0.07123287479542147
        ]
      },
      "test_metrics": {
        "balanced_error": 0.1721965654037806,
        "worst_group_error": 0.23451135510979154,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.23451135510979154,
          0.10988177569776962
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 2.8443377017974854,
      "cost_test": 3.0028393268585205,
      "alpha": [
        0.6533789850477736,
        0.00516880458005264
      ],
      "mu": [
        0.0,
        10.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.14229607233818112,
        "worst_group_error": 0.25777222074712264,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.25777222074712264,
          0.02681992392923962
        ]
      },
      "test_metrics": {
        "balanced_error": 0.13721884846448962,
        "worst_group_error": 0.1990252778343063,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.1990252778343063,
          0.07541241909467294
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.4989999532699585,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.4627977928783108,
        0.4271198711184234,
        0.3925547706925654,
        0.37614272413152045,
        0.3338784873034014,
        0.3114205873264949,
        0.2541429571270124,
        0.19103887697318642,
        0.14229607233818112
      ],
      "worst_group_errors": [
        0.4926724805104102,
        0.481180840791261,
        0.441096760101186,
        0.4613670376971025,
        0.43478859865324737,
        0.4469790893896481,
        0.40691917598484667,
        0.3108448791509514,
        0.25777222074712264
      ],
      "tail_minus_head": [
        -0.05974937526419882,
        -0.1081219393456751,
        -0.09708397881724112,
        -0.17044862713116415,
        -0.20182022269969194,
        -0.2711170041263064,
        -0.30555243771566853,
        -0.23961200435552993,
        -0.230952296817883
      ],
      "aurc_balanced": 0.2585618617719134,
      "aurc_worst_group": 0.33539898224949904,
      "aurc_balanced_coverage_ge_0_2": 0.2585618617719134,
      "aurc_worst_group_coverage_ge_0_2": 0.33539898224949904
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.469235694603072,
        0.4359604463597616,
        0.3947824411993627,
        0.3689486985841257,
        0.32452622701975126,
        0.2900257452731081,
        0.2361513072374946,
        0.1721965654037806,
        0.13721884846448962
      ],
      "worst_group_errors": [
        0.48297135234787425,
        0.47267347862273346,
        0.43275259010955397,
        0.42776102966094387,
        0.38764526737516414,
        0.37983102476711267,
        0.31845646062883537,
        0.23451135510979154,
        0.1990252778343063
      ],
      "tail_minus_head": [
        -0.02747131548960441,
        -0.07342606452594364,
        -0.07594029782038264,
        -0.11762466215363626,
        -0.12623808071082576,
        -0.17961055898800918,
        -0.16461030678268151,
        -0.12462957941202192,
        -0.12361285873963335
      ],
      "aurc_balanced": 0.25254345110331655,
      "aurc_worst_group": 0.2994149762839119,
      "aurc_balanced_coverage_ge_0_2": 0.25254345110331655,
      "aurc_worst_group_coverage_ge_0_2": 0.2994149762839119
    }
  }
}