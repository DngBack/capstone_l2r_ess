{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 15.309643745422363,
      "cost_test": 18.529949188232422,
      "alpha": [
        1.938952974695882,
        0.059992772590114124
      ],
      "mu": [
        0.0,
        0.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4918310662822756,
        "worst_group_error": 0.5378159704525863,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.5378159704525863,
          0.44584616211196487
        ]
      },
      "test_metrics": {
        "balanced_error": 0.5110381508996436,
        "worst_group_error": 0.5614224411851684,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.5614224411851684,
          0.4606538606141186
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 3.1780056953430176,
      "cost_test": 3.3437490463256836,
      "alpha": [
        1.8224918834371415,
        0.050558617212940304
      ],
      "mu": [
        0.0,
        15.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4611001257628541,
        "worst_group_error": 0.538793799623994,
        "coverage": 0.8990000486373901,
        "rejection_rate": 0.10099995136260986,
        "group_errors": [
          0.538793799623994,
          0.3834064519017142
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4779241747241113,
        "worst_group_error": 0.5458424530754696,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5458424530754696,
          0.41000589637275303
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 2.012420177459717,
      "cost_test": 2.032763957977295,
      "alpha": [
        1.6312966309772525,
        0.04444524384352384
      ],
      "mu": [
        0.0,
        21.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.41849822318340313,
        "worst_group_error": 0.5027036515875151,
        "coverage": 0.7990000247955322,
        "rejection_rate": 0.20099997520446777,
        "group_errors": [
          0.5027036515875151,
          0.33429279477929114
        ]
      },
      "test_metrics": {
        "balanced_error": 0.43116175123171896,
        "worst_group_error": 0.5026743436970275,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5026743436970275,
          0.3596491587664105
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 1.897139072418213,
      "cost_test": 1.8787469863891602,
      "alpha": [
        1.4443906835246612,
        0.03923880577252567
      ],
      "mu": [
        0.0,
        22.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3754622718768832,
        "worst_group_error": 0.45181949697983903,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.45181949697983903,
          0.2991050467739273
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3879490441743896,
        "worst_group_error": 0.45351909534646073,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.45351909534646073,
          0.32237899300231837
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 2.901761531829834,
      "cost_test": 2.754423141479492,
      "alpha": [
        1.2980535522854433,
        0.030536711524994042
      ],
      "mu": [
        0.0,
        17.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.31610092616317886,
        "worst_group_error": 0.43159022315340945,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.43159022315340945,
          0.20061162917294822
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3477890454629796,
        "worst_group_error": 0.41209597252418023,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.41209597252418023,
          0.28348211840177906
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 2.496406078338623,
      "cost_test": 2.3433501720428467,
      "alpha": [
        1.148597386443072,
        0.025524770247450444
      ],
      "mu": [
        0.0,
        20.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.25793915620612295,
        "worst_group_error": 0.36157118355976,
        "coverage": 0.5,
        "rejection_rate": 0.5,
        "group_errors": [
          0.36157118355976,
          0.15430712885248588
        ]
      },
      "test_metrics": {
        "balanced_error": 0.29140173043942186,
        "worst_group_error": 0.3509113176628,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.3509113176628,
          0.23189214321604368
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 2.854388952255249,
      "cost_test": 2.6195127964019775,
      "alpha": [
        0.9764532641771992,
        0.0184827275432646
      ],
      "mu": [
        0.0,
        18.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.22664770803935785,
        "worst_group_error": 0.32592110644443273,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.32592110644443273,
          0.127374309634283
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2293237649436915,
        "worst_group_error": 0.285725796307785,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.285725796307785,
          0.17292173357959803
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 2.0047810077667236,
      "cost_test": 1.8406131267547607,
      "alpha": [
        0.7571359488423159,
        0.016499075777219832
      ],
      "mu": [
        0.0,
        22.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.15412705037229102,
        "worst_group_error": 0.2108515036691216,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.2108515036691216,
          0.09740259707546048
        ]
      },
      "test_metrics": {
        "balanced_error": 0.1563711362184158,
        "worst_group_error": 0.1812805988570282,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.1812805988570282,
          0.1314616735798034
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 2.4933736324310303,
      "cost_test": 2.169182538986206,
      "alpha": [
        0.5633425571558743,
        0.009279468523833085
      ],
      "mu": [
        0.0,
        17.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.07490910267350297,
        "worst_group_error": 0.0912596419018102,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.0912596419018102,
          0.05855856344519573
        ]
      },
      "test_metrics": {
        "balanced_error": 0.07874307837933045,
        "worst_group_error": 0.09924675501869612,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.09924675501869612,
          0.05823940173996477
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0,
        0.10099995136260986,
        0.20099997520446777,
        0.2999999523162842,
        0.3999999761581421,
        0.5,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.4918310662822756,
        0.4611001257628541,
        0.41849822318340313,
        0.3754622718768832,
        0.31610092616317886,
        0.25793915620612295,
        0.22664770803935785,
        0.15412705037229102,
        0.07490910267350297
      ],
      "worst_group_errors": [
        0.5378159704525863,
        0.538793799623994,
        0.5027036515875151,
        0.45181949697983903,
        0.43159022315340945,
        0.36157118355976,
        0.32592110644443273,
        0.2108515036691216,
        0.0912596419018102
      ],
      "tail_minus_head": [
        -0.09196980834062146,
        -0.1553873477222798,
        -0.16841085680822393,
        -0.15271445020591173,
        -0.23097859398046122,
        -0.2072640547072741,
        -0.19854679681014972,
        -0.11344890659366111,
        -0.03270107845661447
      ],
      "aurc_balanced": 0.24916173588703402,
      "aurc_worst_group": 0.31349616371580025,
      "aurc_balanced_coverage_ge_0_2": 0.24916173588703402,
      "aurc_worst_group_coverage_ge_0_2": 0.31349616371580025
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.5110381508996436,
        0.4779241747241113,
        0.43116175123171896,
        0.3879490441743896,
        0.3477890454629796,
        0.29140173043942186,
        0.2293237649436915,
        0.1563711362184158,
        0.07874307837933045
      ],
      "worst_group_errors": [
        0.5614224411851684,
        0.5458424530754696,
        0.5026743436970275,
        0.45351909534646073,
        0.41209597252418023,
        0.3509113176628,
        0.285725796307785,
        0.1812805988570282,
        0.09924675501869612
      ],
      "tail_minus_head": [
        -0.10076858057104976,
        -0.1358365567027166,
        -0.14302518493061694,
        -0.13114010234414236,
        -0.12861385412240117,
        -0.1190191744467563,
        -0.11280406272818697,
        -0.04981892527722481,
        -0.04100735327873135
      ],
      "aurc_balanced": 0.2616411656074517,
      "aurc_worst_group": 0.3061907176555242,
      "aurc_balanced_coverage_ge_0_2": 0.2616411656074517,
      "aurc_worst_group_coverage_ge_0_2": 0.3061907176555242
    }
  }
}