{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 3.2129058837890625,
      "cost_test": 6.587977409362793,
      "alpha": [
        1.9400074333784052,
        0.05999241247372958
      ],
      "mu": [
        0.0,
        15.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.46919884783129884,
        "worst_group_error": 0.5600000432877781,
        "coverage": 0.999000072479248,
        "rejection_rate": 0.0009999275207519531,
        "group_errors": [
          0.37839765237481965,
          0.5600000432877781
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4786492137391989,
        "worst_group_error": 0.5648077239655526,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.3924907035128452,
          0.5648077239655526
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 1.0607625246047974,
      "cost_test": 1.0691187381744385,
      "alpha": [
        1.8170471065485971,
        0.0498951972880953
      ],
      "mu": [
        0.0,
        20.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4309505847097437,
        "worst_group_error": 0.5058907915655606,
        "coverage": 0.8990000486373901,
        "rejection_rate": 0.10099995136260986,
        "group_errors": [
          0.3560103778539267,
          0.5058907915655606
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4420033508336937,
        "worst_group_error": 0.5217697772975506,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.3622369243698368,
          0.5217697772975506
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 0.8591610193252563,
      "cost_test": 0.8417754173278809,
      "alpha": [
        1.6340735915503228,
        0.045437141251869956
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.39244764078684197,
        "worst_group_error": 0.47106763140072616,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.3138276501729578,
          0.47106763140072616
        ]
      },
      "test_metrics": {
        "balanced_error": 0.399941508276762,
        "worst_group_error": 0.4809319963380679,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.3189510202154562,
          0.4809319963380679
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 1.0884451866149902,
      "cost_test": 1.0414164066314697,
      "alpha": [
        1.498442861272049,
        0.03713191495838079
      ],
      "mu": [
        0.0,
        18.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3452750498162139,
        "worst_group_error": 0.4132443330645957,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.27730576656783207,
          0.4132443330645957
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3611153693044912,
        "worst_group_error": 0.43320693992950465,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.28902379867947775,
          0.43320693992950465
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 1.0507011413574219,
      "cost_test": 1.0169792175292969,
      "alpha": [
        1.3344528895376655,
        0.031367365459384546
      ],
      "mu": [
        0.0,
        18.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2938945868395515,
        "worst_group_error": 0.34047760823404805,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.2473115654450549,
          0.34047760823404805
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3219742487790341,
        "worst_group_error": 0.3916924925590451,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.25225600499902306,
          0.3916924925590451
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 0.9237649440765381,
      "cost_test": 0.8761649131774902,
      "alpha": [
        1.1389145242975824,
        0.025871693882305688
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.23555841884642795,
        "worst_group_error": 0.25110456923970625,
        "coverage": 0.5010000467300415,
        "rejection_rate": 0.4989999532699585,
        "group_errors": [
          0.22001226845314964,
          0.25110456923970625
        ]
      },
      "test_metrics": {
        "balanced_error": 0.27727429506245954,
        "worst_group_error": 0.3307892252922403,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.22375936483267878,
          0.3307892252922403
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 1.306851863861084,
      "cost_test": 1.2394332885742188,
      "alpha": [
        1.0271178988500114,
        0.01831071084843785
      ],
      "mu": [
        0.0,
        12.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.20262178255248672,
        "worst_group_error": 0.2395480310021921,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.16569553410278134,
          0.2395480310021921
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2401117650525842,
        "worst_group_error": 0.296810497254611,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.1834130328505574,
          0.296810497254611
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 1.359165906906128,
      "cost_test": 1.3008673191070557,
      "alpha": [
        0.8229620155134412,
        0.012355309832131102
      ],
      "mu": [
        0.0,
        8.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.15030587685687494,
        "worst_group_error": 0.16693680580110484,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.13367494791264503,
          0.16693680580110484
        ]
      },
      "test_metrics": {
        "balanced_error": 0.1857945104766804,
        "worst_group_error": 0.22256391763268404,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.14902510332067678,
          0.22256391763268404
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 0.8117742538452148,
      "cost_test": 0.7197647094726562,
      "alpha": [
        0.5288249840953008,
        0.009506113997335953
      ],
      "mu": [
        0.0,
        19.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.11353628508635791,
        "worst_group_error": 0.12828573019523348,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.12828573019523348,
          0.09878683997748232
        ]
      },
      "test_metrics": {
        "balanced_error": 0.11600015591560722,
        "worst_group_error": 0.12323233292139212,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.10876797890982233,
          0.12323233292139212
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0009999275207519531,
        0.10099995136260986,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.4989999532699585,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.46919884783129884,
        0.4309505847097437,
        0.39244764078684197,
        0.3452750498162139,
        0.2938945868395515,
        0.23555841884642795,
        0.20262178255248672,
        0.15030587685687494,
        0.11353628508635791
      ],
      "worst_group_errors": [
        0.5600000432877781,
        0.5058907915655606,
        0.47106763140072616,
        0.4132443330645957,
        0.34047760823404805,
        0.25110456923970625,
        0.2395480310021921,
        0.16693680580110484,
        0.12828573019523348
      ],
      "tail_minus_head": [
        0.18160239091295843,
        0.1498804137116339,
        0.1572399812277684,
        0.1359385664967636,
        0.09316604278899315,
        0.031092300786556615,
        0.07385249689941076,
        0.03326185788845981,
        -0.029498890217751164
      ],
      "aurc_balanced": 0.23356574660368723,
      "aurc_worst_group": 0.27245702060551813,
      "aurc_balanced_coverage_ge_0_2": 0.23356574660368723,
      "aurc_worst_group_coverage_ge_0_2": 0.27245702060551813
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.4786492137391989,
        0.4420033508336937,
        0.399941508276762,
        0.3611153693044912,
        0.3219742487790341,
        0.27727429506245954,
        0.2401117650525842,
        0.1857945104766804,
        0.11600015591560722
      ],
      "worst_group_errors": [
        0.5648077239655526,
        0.5217697772975506,
        0.4809319963380679,
        0.43320693992950465,
        0.3916924925590451,
        0.3307892252922403,
        0.296810497254611,
        0.22256391763268404,
        0.12323233292139212
      ],
      "tail_minus_head": [
        0.17231702045270736,
        0.1595328529277138,
        0.1619809761226117,
        0.1441831412500269,
        0.13943648756002203,
        0.10702986045956153,
        0.1133974644040536,
        0.07353881431200726,
        0.014464354011569786
      ],
      "aurc_balanced": 0.2525165106805117,
      "aurc_worst_group": 0.3021333213747307,
      "aurc_balanced_coverage_ge_0_2": 0.2525165106805117,
      "aurc_worst_group_coverage_ge_0_2": 0.3021333213747307
    }
  }
}