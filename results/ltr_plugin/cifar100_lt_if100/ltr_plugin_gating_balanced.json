{
  "objective": "balanced",
  "description": "Gating with 3 experts (CE, LogitAdjust, BalancedSoftmax) - Targeted rejection grid with val-based hyperparameter selection per paper Algorithm 1",
  "method": "plug-in_balanced_val_selection_with_gating",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 5.862724304199219,
      "cost_test": 6.597648620605469,
      "alpha": [
        0.69,
        0.31
      ],
      "mu": [
        0.0,
        -5.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.43040149185653853,
        "coverage": 0.999000072479248,
        "rejection_rate": 0.0009999275207519531,
        "group_errors": [
          0.27705759103006966,
          0.5837453926830074
        ],
        "worst_group_error": 0.5837453926830074
      },
      "test_metrics": {
        "balanced_error": 0.4364108126521542,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.28201386136121964,
          0.5908077639430888
        ],
        "worst_group_error": 0.5908077639430888
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 1.2984286546707153,
      "cost_test": 1.305060625076294,
      "alpha": [
        0.6269296875,
        0.2730703125
      ],
      "mu": [
        0.0,
        1.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3954103412982274,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.24722206316201356,
          0.5435986194344412
        ],
        "worst_group_error": 0.5435986194344412
      },
      "test_metrics": {
        "balanced_error": 0.39896133258499067,
        "coverage": 0.8998750448226929,
        "rejection_rate": 0.10012495517730713,
        "group_errors": [
          0.24803681995648733,
          0.549885845213494
        ],
        "worst_group_error": 0.549885845213494
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 1.21974778175354,
      "cost_test": 1.232306957244873,
      "alpha": [
        0.560161358833313,
        0.23982123088836668
      ],
      "mu": [
        0.0,
        2.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.36053145679579923,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.21260832418224085,
          0.5084545894093576
        ],
        "worst_group_error": 0.5084545894093576
      },
      "test_metrics": {
        "balanced_error": 0.3605308120179779,
        "coverage": 0.799875020980835,
        "rejection_rate": 0.20012497901916504,
        "group_errors": [
          0.21313634359697847,
          0.5079252804389772
        ],
        "worst_group_error": 0.5079252804389772
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 1.1291007995605469,
      "cost_test": 1.1320347785949707,
      "alpha": [
        0.48692089843749997,
        0.21300320434570313
      ],
      "mu": [
        0.0,
        2.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.31420169174251933,
        "coverage": 0.6990000605583191,
        "rejection_rate": 0.3009999394416809,
        "group_errors": [
          0.17612860278901124,
          0.4522747806960274
        ],
        "worst_group_error": 0.4522747806960274
      },
      "test_metrics": {
        "balanced_error": 0.3248766210521904,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.17657070825449467,
          0.4731825338498861
        ],
        "worst_group_error": 0.4731825338498861
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 1.0390145778656006,
      "cost_test": 1.0483379364013672,
      "alpha": [
        0.4099505310058593,
        0.19005557250976562
      ],
      "mu": [
        0.0,
        3.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.28779516439923203,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.14738389158776133,
          0.42820643721070273
        ],
        "worst_group_error": 0.42820643721070273
      },
      "test_metrics": {
        "balanced_error": 0.28631364588566727,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.13847408241445264,
          0.4341532093568819
        ],
        "worst_group_error": 0.4341532093568819
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 0.9957655668258667,
      "cost_test": 1.0099514722824097,
      "alpha": [
        0.34096325683593753,
        0.16006719970703126
      ],
      "mu": [
        0.0,
        4.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.24109574409223875,
        "coverage": 0.5010000467300415,
        "rejection_rate": 0.4989999532699585,
        "group_errors": [
          0.12987607320084293,
          0.35231541498363456
        ],
        "worst_group_error": 0.35231541498363456
      },
      "test_metrics": {
        "balanced_error": 0.24836196569166957,
        "coverage": 0.5001250505447388,
        "rejection_rate": 0.49987494945526123,
        "group_errors": [
          0.11249042113566426,
          0.3842335102476749
        ],
        "worst_group_error": 0.3842335102476749
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 1.3702285289764404,
      "cost_test": 1.4202275276184082,
      "alpha": [
        0.2959481964111328,
        0.10506094360351562
      ],
      "mu": [
        0.0,
        3.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.19774884959766353,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.09332580710405862,
          0.30217189209126843
        ],
        "worst_group_error": 0.30217189209126843
      },
      "test_metrics": {
        "balanced_error": 0.19153996805769355,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.07937278312337072,
          0.3037071529920164
        ],
        "worst_group_error": 0.3037071529920164
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 1.4635703563690186,
      "cost_test": 1.4805047512054443,
      "alpha": [
        0.22895086669921877,
        0.07207046508789061
      ],
      "mu": [
        0.0,
        4.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.11978754624296636,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.06100366941222161,
          0.17857142307371113
        ],
        "worst_group_error": 0.17857142307371113
      },
      "test_metrics": {
        "balanced_error": 0.11758347000742886,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.04509302978171348,
          0.19007391023314424
        ],
        "worst_group_error": 0.19007391023314424
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 1.049917221069336,
      "cost_test": 1.1649818420410156,
      "alpha": [
        0.14694173431396484,
        0.05406436157226563
      ],
      "mu": [
        0.0,
        6.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.03577965671815996,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.020130742148490068,
          0.051428571287829856
        ],
        "worst_group_error": 0.051428571287829856
      },
      "test_metrics": {
        "balanced_error": 0.060600563623597586,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.03209900521748845,
          0.08910212202970672
        ],
        "worst_group_error": 0.08910212202970672
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0009999275207519531,
        0.09999996423721313,
        0.19999998807907104,
        0.3009999394416809,
        0.3999999761581421,
        0.4989999532699585,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.43040149185653853,
        0.3954103412982274,
        0.36053145679579923,
        0.31420169174251933,
        0.28779516439923203,
        0.24109574409223875,
        0.19774884959766353,
        0.11978754624296636,
        0.03577965671815996
      ],
      "worst_errors": [
        0.5837453926830074,
        0.5435986194344412,
        0.5084545894093576,
        0.4522747806960274,
        0.42820643721070273,
        0.35231541498363456,
        0.30217189209126843,
        0.17857142307371113,
        0.051428571287829856
      ],
      "head_errors": [
        0.27705759103006966,
        0.24722206316201356,
        0.21260832418224085,
        0.17612860278901124,
        0.14738389158776133,
        0.12987607320084293,
        0.09332580710405862,
        0.06100366941222161,
        0.020130742148490068
      ],
      "tail_errors": [
        0.5837453926830074,
        0.5435986194344412,
        0.5084545894093576,
        0.4522747806960274,
        0.42820643721070273,
        0.35231541498363456,
        0.30217189209126843,
        0.17857142307371113,
        0.051428571287829856
      ],
      "error_gap": [
        0.30668780165293774,
        0.29637655627242765,
        0.29584626522711677,
        0.2761461779070161,
        0.2808225456229414,
        0.22243934178279162,
        0.2088460849872098,
        0.11756775366148953,
        0.03129782913933979
      ],
      "aurc": 0.21432517252284716,
      "aurc_worst": 0.307404231249105,
      "aurc_gap": 0.18615811745251556
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.10012495517730713,
        0.20012497901916504,
        0.2999999523162842,
        0.3999999761581421,
        0.49987494945526123,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.4364108126521542,
        0.39896133258499067,
        0.3605308120179779,
        0.3248766210521904,
        0.28631364588566727,
        0.24836196569166957,
        0.19153996805769355,
        0.11758347000742886,
        0.060600563623597586
      ],
      "worst_errors": [
        0.5908077639430888,
        0.549885845213494,
        0.5079252804389772,
        0.4731825338498861,
        0.4341532093568819,
        0.3842335102476749,
        0.3037071529920164,
        0.19007391023314424,
        0.08910212202970672
      ],
      "head_errors": [
        0.28201386136121964,
        0.24803681995648733,
        0.21313634359697847,
        0.17657070825449467,
        0.13847408241445264,
        0.11249042113566426,
        0.07937278312337072,
        0.04509302978171348,
        0.03209900521748845
      ],
      "tail_errors": [
        0.5908077639430888,
        0.549885845213494,
        0.5079252804389772,
        0.4731825338498861,
        0.4341532093568819,
        0.3842335102476749,
        0.3037071529920164,
        0.19007391023314424,
        0.08910212202970672
      ],
      "error_gap": [
        0.3087939025818691,
        0.30184902525700674,
        0.29478893684199875,
        0.29661182559539145,
        0.29567912694242926,
        0.2717430891120106,
        0.2243343698686457,
        0.14498088045143076,
        0.057003116812218264
      ],
      "aurc": 0.2176432956385117,
      "aurc_worst": 0.318270450565315,
      "aurc_gap": 0.20125430985360662
    }
  }
}