{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 22.303037643432617,
      "cost_test": 25.257347106933594,
      "alpha": [
        1.9400202752050468,
        0.059958588288599665
      ],
      "mu": [
        0.0,
        -5.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.5139364723373272,
        "worst_group_error": 0.5952575646035072,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.5952575646035072,
          0.4326153800711473
        ]
      },
      "test_metrics": {
        "balanced_error": 0.5197605946962004,
        "worst_group_error": 0.6035211506880345,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.6035211506880345,
          0.43600003870436627
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 1.7403945922851562,
      "cost_test": 1.6989760398864746,
      "alpha": [
        1.7883476520234862,
        0.05377723089678438
      ],
      "mu": [
        0.0,
        23.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4801908898449264,
        "worst_group_error": 0.5764938745656738,
        "coverage": 0.9000000357627869,
        "rejection_rate": 0.09999996423721313,
        "group_errors": [
          0.5764938745656738,
          0.383887905124179
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4802401539946365,
        "worst_group_error": 0.5741643002036669,
        "coverage": 0.8998750448226929,
        "rejection_rate": 0.10012495517730713,
        "group_errors": [
          0.5741643002036669,
          0.386316007785606
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 2.845851421356201,
      "cost_test": 2.883758544921875,
      "alpha": [
        1.645406716233773,
        0.04438335141318833
      ],
      "mu": [
        0.0,
        21.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.445915120717125,
        "worst_group_error": 0.5621879683569271,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.5621879683569271,
          0.32964227307732297
        ]
      },
      "test_metrics": {
        "balanced_error": 0.44948951094990675,
        "worst_group_error": 0.557234655003967,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.557234655003967,
          0.3417443668958466
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 3.3937606811523438,
      "cost_test": 3.514333724975586,
      "alpha": [
        1.483752966165855,
        0.03603155651948432
      ],
      "mu": [
        0.0,
        20.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.40980654834697583,
        "worst_group_error": 0.5286315366126305,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.5286315366126305,
          0.2909815600813211
        ]
      },
      "test_metrics": {
        "balanced_error": 0.41636986818826144,
        "worst_group_error": 0.529587425268374,
        "coverage": 0.7000000476837158,
        "rejection_rate": 0.2999999523162842,
        "group_errors": [
          0.529587425268374,
          0.3031523111081489
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 3.745744228363037,
      "cost_test": 4.069013595581055,
      "alpha": [
        1.3383762354443212,
        0.02832851060323309
      ],
      "mu": [
        0.0,
        20.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.358750699920137,
        "worst_group_error": 0.47209136269438257,
        "coverage": 0.5990000367164612,
        "rejection_rate": 0.4009999632835388,
        "group_errors": [
          0.47209136269438257,
          0.2454100371458914
        ]
      },
      "test_metrics": {
        "balanced_error": 0.379461721627778,
        "worst_group_error": 0.4964264078739236,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.4964264078739236,
          0.26249703538163244
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 3.796086311340332,
      "cost_test": 3.8266263008117676,
      "alpha": [
        1.1725848569641797,
        0.022240525670677684
      ],
      "mu": [
        0.0,
        22.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3152024669634606,
        "worst_group_error": 0.43229173673714594,
        "coverage": 0.5010000467300415,
        "rejection_rate": 0.4989999532699585,
        "group_errors": [
          0.43229173673714594,
          0.19811319718977524
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3279406527390351,
        "worst_group_error": 0.4440576825641293,
        "coverage": 0.5,
        "rejection_rate": 0.5,
        "group_errors": [
          0.4440576825641293,
          0.21182362291394094
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 4.135349273681641,
      "cost_test": 4.200373649597168,
      "alpha": [
        0.9946275214913864,
        0.01634120001771197
      ],
      "mu": [
        0.0,
        19.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2624055271183528,
        "worst_group_error": 0.37258884497704103,
        "coverage": 0.4010000228881836,
        "rejection_rate": 0.5989999771118164,
        "group_errors": [
          0.37258884497704103,
          0.15222220925966454
        ]
      },
      "test_metrics": {
        "balanced_error": 0.27674665244102603,
        "worst_group_error": 0.39144610975312155,
        "coverage": 0.40012502670288086,
        "rejection_rate": 0.5998749732971191,
        "group_errors": [
          0.39144610975312155,
          0.16204719512893045
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 3.7859513759613037,
      "cost_test": 3.9081778526306152,
      "alpha": [
        0.8025326957719747,
        0.011352382494760435
      ],
      "mu": [
        0.0,
        21.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.16418455504983098,
        "worst_group_error": 0.290734700469669,
        "coverage": 0.30100002884864807,
        "rejection_rate": 0.6989999711513519,
        "group_errors": [
          0.290734700469669,
          0.03763440962999298
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2079059517241683,
        "worst_group_error": 0.30025804789855987,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.30025804789855987,
          0.11555385554977672
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 2.8369383811950684,
      "cost_test": 3.150017738342285,
      "alpha": [
        0.5482852262071305,
        0.008950428591307551
      ],
      "mu": [
        0.0,
        21.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.07627890698751442,
        "worst_group_error": 0.15255781397502885,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.15255781397502885,
          0.0
        ]
      },
      "test_metrics": {
        "balanced_error": 0.10866185130245362,
        "worst_group_error": 0.1442117536091388,
        "coverage": 0.20012500882148743,
        "rejection_rate": 0.7998749911785126,
        "group_errors": [
          0.1442117536091388,
          0.07311194899576845
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0,
        0.09999996423721313,
        0.19999998807907104,
        0.2999999523162842,
        0.4009999632835388,
        0.4989999532699585,
        0.5989999771118164,
        0.6989999711513519,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.5139364723373272,
        0.4801908898449264,
        0.445915120717125,
        0.40980654834697583,
        0.358750699920137,
        0.3152024669634606,
        0.2624055271183528,
        0.16418455504983098,
        0.07627890698751442
      ],
      "worst_group_errors": [
        0.5952575646035072,
        0.5764938745656738,
        0.5621879683569271,
        0.5286315366126305,
        0.47209136269438257,
        0.43229173673714594,
        0.37258884497704103,
        0.290734700469669,
        0.15255781397502885
      ],
      "tail_minus_head": [
        -0.1626421845323599,
        -0.19260596944149483,
        -0.23254569527960411,
        -0.23764997653130943,
        -0.22668132554849116,
        -0.2341785395473707,
        -0.2203666357173765,
        -0.253100290839676,
        -0.15255781397502885
      ],
      "aurc_balanced": 0.2728666625027122,
      "aurc_worst_group": 0.36048873669877946,
      "aurc_balanced_coverage_ge_0_2": 0.2728666625027122,
      "aurc_worst_group_coverage_ge_0_2": 0.36048873669877946
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.10012495517730713,
        0.19999998807907104,
        0.2999999523162842,
        0.3999999761581421,
        0.5,
        0.5998749732971191,
        0.699874997138977,
        0.7998749911785126
      ],
      "balanced_errors": [
        0.5197605946962004,
        0.4802401539946365,
        0.44948951094990675,
        0.41636986818826144,
        0.379461721627778,
        0.3279406527390351,
        0.27674665244102603,
        0.2079059517241683,
        0.10866185130245362
      ],
      "worst_group_errors": [
        0.6035211506880345,
        0.5741643002036669,
        0.557234655003967,
        0.529587425268374,
        0.4964264078739236,
        0.4440576825641293,
        0.39144610975312155,
        0.30025804789855987,
        0.1442117536091388
      ],
      "tail_minus_head": [
        -0.1675211119836682,
        -0.18784829241806095,
        -0.21549028810812038,
        -0.2264351141602251,
        -0.23392937249229118,
        -0.23223405965018837,
        -0.2293989146241911,
        -0.18470419234878316,
        -0.07109980461337034
      ],
      "aurc_balanced": 0.2852031645338743,
      "aurc_worst_group": 0.36665477398392987,
      "aurc_balanced_coverage_ge_0_2": 0.2852031645338743,
      "aurc_worst_group_coverage_ge_0_2": 0.36665477398392987
    }
  }
}