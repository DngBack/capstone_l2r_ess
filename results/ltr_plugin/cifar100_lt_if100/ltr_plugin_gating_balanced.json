{
  "objectives": [
    "balanced",
    "worst_group"
  ],
  "description": "CORRECTED: Targeted rejection grid (0.0..0.8) with val-based hyperparameter selection per paper Algorithm 1. Uses 3 experts with gating network.",
  "method": "plug-in_balanced_val_selection_gating",
  "hyperparameter_selection": "val_based",
  "algorithm": "Algorithm 1 from paper - optimize (\u03b1,\u03bc) on tunev, select \u03bc on val",
  "experts": [
    "ce_baseline",
    "logitadjust_baseline",
    "balsoftmax_baseline"
  ],
  "results_per_cost": [
    {
      "target_rejection": 0.0,
      "cost_val": 16.12578582763672,
      "cost_test": 20.333568572998047,
      "alpha": [
        1.9400071965816694,
        0.05999276146178542
      ],
      "mu": [
        0.0,
        -6.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.4690539048209321,
        "worst_group_error": 0.5600000152780403,
        "coverage": 0.9990000128746033,
        "rejection_rate": 0.0009999871253967285,
        "group_errors": [
          0.37810779436382397,
          0.5600000152780403
        ]
      },
      "test_metrics": {
        "balanced_error": 0.4786492317166055,
        "worst_group_error": 0.5648077599203658,
        "coverage": 1.0,
        "rejection_rate": 0.0,
        "group_errors": [
          0.3924907035128452,
          0.5648077599203658
        ]
      }
    },
    {
      "target_rejection": 0.1,
      "cost_val": 1.0319747924804688,
      "cost_test": 1.038299560546875,
      "alpha": [
        1.8169553116765833,
        0.04989687040056141
      ],
      "mu": [
        0.0,
        21.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.43033157991047694,
        "worst_group_error": 0.5046528059674393,
        "coverage": 0.8989999890327454,
        "rejection_rate": 0.10100001096725464,
        "group_errors": [
          0.35601035385351454,
          0.5046528059674393
        ]
      },
      "test_metrics": {
        "balanced_error": 0.44156484399685125,
        "worst_group_error": 0.5215975025171888,
        "coverage": 0.8999999761581421,
        "rejection_rate": 0.10000002384185791,
        "group_errors": [
          0.3615321854765136,
          0.5215975025171888
        ]
      }
    },
    {
      "target_rejection": 0.2,
      "cost_val": 0.8591611385345459,
      "cost_test": 0.8417755365371704,
      "alpha": [
        1.6340735131672404,
        0.045437135699267675
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.39244762774803654,
        "worst_group_error": 0.4710675916862892,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.3138276638097839,
          0.4710675916862892
        ]
      },
      "test_metrics": {
        "balanced_error": 0.39994148452485784,
        "worst_group_error": 0.4809319963380679,
        "coverage": 0.800000011920929,
        "rejection_rate": 0.19999998807907104,
        "group_errors": [
          0.3189509727116478,
          0.4809319963380679
        ]
      }
    },
    {
      "target_rejection": 0.3,
      "cost_val": 1.0884531736373901,
      "cost_test": 1.041438102722168,
      "alpha": [
        1.498417037869956,
        0.037131910312454275
      ],
      "mu": [
        0.0,
        18.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.3452750302579184,
        "worst_group_error": 0.4132443330645957,
        "coverage": 0.699999988079071,
        "rejection_rate": 0.30000001192092896,
        "group_errors": [
          0.27730572745124116,
          0.4132443330645957
        ]
      },
      "test_metrics": {
        "balanced_error": 0.361115390886874,
        "worst_group_error": 0.43320698309427025,
        "coverage": 0.699999988079071,
        "rejection_rate": 0.30000001192092896,
        "group_errors": [
          0.28902379867947775,
          0.43320698309427025
        ]
      }
    },
    {
      "target_rejection": 0.4,
      "cost_val": 1.0507001876831055,
      "cost_test": 1.0169792175292969,
      "alpha": [
        1.3344527269645057,
        0.03136736162684581
      ],
      "mu": [
        0.0,
        18.5
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.2938945867656491,
        "worst_group_error": 0.3404776513702701,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.24731152216102814,
          0.3404776513702701
        ]
      },
      "test_metrics": {
        "balanced_error": 0.3219742487790341,
        "worst_group_error": 0.3916924925590451,
        "coverage": 0.6000000238418579,
        "rejection_rate": 0.3999999761581421,
        "group_errors": [
          0.25225600499902306,
          0.3916924925590451
        ]
      }
    },
    {
      "target_rejection": 0.5,
      "cost_val": 0.9237651824951172,
      "cost_test": 0.8761653900146484,
      "alpha": [
        1.138914293129881,
        0.025871686907459814
      ],
      "mu": [
        0.0,
        23.25
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.23555842975409172,
        "worst_group_error": 0.25110456923970625,
        "coverage": 0.5009999871253967,
        "rejection_rate": 0.49900001287460327,
        "group_errors": [
          0.22001229026847718,
          0.25110456923970625
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2772743124146451,
        "worst_group_error": 0.33078925999661146,
        "coverage": 0.500124990940094,
        "rejection_rate": 0.499875009059906,
        "group_errors": [
          0.22375936483267878,
          0.33078925999661146
        ]
      }
    },
    {
      "target_rejection": 0.6,
      "cost_val": 1.3068516254425049,
      "cost_test": 1.2394342422485352,
      "alpha": [
        1.027117654357578,
        0.018310710489883114
      ],
      "mu": [
        0.0,
        12.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.20262177827308564,
        "worst_group_error": 0.23954801761300962,
        "coverage": 0.4009999930858612,
        "rejection_rate": 0.5990000069141388,
        "group_errors": [
          0.1656955389331617,
          0.23954801761300962
        ]
      },
      "test_metrics": {
        "balanced_error": 0.2401117725506572,
        "worst_group_error": 0.296810497254611,
        "coverage": 0.40012499690055847,
        "rejection_rate": 0.5998750030994415,
        "group_errors": [
          0.1834130478467034,
          0.296810497254611
        ]
      }
    },
    {
      "target_rejection": 0.7,
      "cost_val": 1.359166145324707,
      "cost_test": 1.3008675575256348,
      "alpha": [
        0.822961855625633,
        0.012355309265211646
      ],
      "mu": [
        0.0,
        8.75
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.1503058663782429,
        "worst_group_error": 0.16693678484384072,
        "coverage": 0.3009999990463257,
        "rejection_rate": 0.6990000009536743,
        "group_errors": [
          0.13367494791264503,
          0.16693678484384072
        ]
      },
      "test_metrics": {
        "balanced_error": 0.18579447704224808,
        "worst_group_error": 0.22256388005098332,
        "coverage": 0.30012500286102295,
        "rejection_rate": 0.699874997138977,
        "group_errors": [
          0.14902507403351284,
          0.22256388005098332
        ]
      }
    },
    {
      "target_rejection": 0.8,
      "cost_val": 0.8117742538452148,
      "cost_test": 0.7197647094726562,
      "alpha": [
        0.5288249233798075,
        0.00950611283745548
      ],
      "mu": [
        0.0,
        19.0
      ],
      "selection_method": "val_based",
      "val_metrics": {
        "balanced_error": 0.11353628065871069,
        "worst_group_error": 0.12828573019523348,
        "coverage": 0.20100000500679016,
        "rejection_rate": 0.7989999949932098,
        "group_errors": [
          0.12828573019523348,
          0.09878683112218788
        ]
      },
      "test_metrics": {
        "balanced_error": 0.11600014401735036,
        "worst_group_error": 0.12323230186993527,
        "coverage": 0.20012499392032623,
        "rejection_rate": 0.7998750060796738,
        "group_errors": [
          0.10876798616476545,
          0.12323230186993527
        ]
      }
    }
  ],
  "rc_curve": {
    "val": {
      "rejection_rates": [
        0.0009999871253967285,
        0.10100001096725464,
        0.19999998807907104,
        0.30000001192092896,
        0.3999999761581421,
        0.49900001287460327,
        0.5990000069141388,
        0.6990000009536743,
        0.7989999949932098
      ],
      "balanced_errors": [
        0.4690539048209321,
        0.43033157991047694,
        0.39244762774803654,
        0.3452750302579184,
        0.2938945867656491,
        0.23555842975409172,
        0.20262177827308564,
        0.1503058663782429,
        0.11353628065871069
      ],
      "worst_group_errors": [
        0.5600000152780403,
        0.5046528059674393,
        0.4710675916862892,
        0.4132443330645957,
        0.3404776513702701,
        0.25110456923970625,
        0.23954801761300962,
        0.16693678484384072,
        0.12828573019523348
      ],
      "tail_minus_head": [
        0.18189222091421636,
        0.1486424521139248,
        0.15723992787650531,
        0.13593860561335452,
        0.09316612920924194,
        0.03109227897122907,
        0.07385247867984793,
        0.03326183693119569,
        -0.029498899073045606
      ],
      "aurc_balanced": 0.2334968883171134,
      "aurc_worst_group": 0.27233381723957745,
      "aurc_balanced_coverage_ge_0_2": 0.2334968883171134,
      "aurc_worst_group_coverage_ge_0_2": 0.27233381723957745
    },
    "test": {
      "rejection_rates": [
        0.0,
        0.10000002384185791,
        0.19999998807907104,
        0.30000001192092896,
        0.3999999761581421,
        0.499875009059906,
        0.5998750030994415,
        0.699874997138977,
        0.7998750060796738
      ],
      "balanced_errors": [
        0.4786492317166055,
        0.44156484399685125,
        0.39994148452485784,
        0.361115390886874,
        0.3219742487790341,
        0.2772743124146451,
        0.2401117725506572,
        0.18579447704224808,
        0.11600014401735036
      ],
      "worst_group_errors": [
        0.5648077599203658,
        0.5215975025171888,
        0.4809319963380679,
        0.43320698309427025,
        0.3916924925590451,
        0.33078925999661146,
        0.296810497254611,
        0.22256388005098332,
        0.12323230186993527
      ],
      "tail_minus_head": [
        0.1723170564075206,
        0.16006531704067523,
        0.16198102362642008,
        0.1441831844147925,
        0.13943648756002203,
        0.10702989516393269,
        0.11339744940790761,
        0.07353880601747048,
        0.014464315705169817
      ],
      "aurc_balanced": 0.25247266994761536,
      "aurc_worst_group": 0.30211611034546954,
      "aurc_balanced_coverage_ge_0_2": 0.25247266994761536,
      "aurc_worst_group_coverage_ge_0_2": 0.30211611034546954
    }
  }
}